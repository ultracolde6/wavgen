import wavgen

r = [2.094510589860613, 5.172224588379723, 2.713365750754814, 2.7268654021553975, 1.   /
     9455621726067513, 2.132845902763719, 5.775685169342227, 4.178303582622483, 1.971  /
     4912917733933, 1.218844007759545, 4.207174369712666, 2.6609861484752124, 3.41140  /
     54221128125, 1.0904071328591276, 1.0874359520279866, 1.538248528697041, 0.501676  /
     9726252504, 2.058427862897829, 6.234202186024447, 5.665480185178818]

if __name__=='__main__':
    ntraps = 11
    startfreq = 100E6
    startfreq = 95E6
    freq_A = [startfreq + j * 1E6 for j in range(ntraps)]
    mag_A = [1,1,1,1,1,1,1,1,1,1,1]
    mag_A = [1,0.996,0.896,0.831,0.874,0.875,0.850,0.854,0.864,0.858,0.883]
    mag_A = [1,0.998,0.903,0.831,0.874,0.880,0.862,0.863,0.868,0.858,0.877]
    mag_A = [1,0.999,0.909,0.832,0.876,0.880,0.870,0.873,0.869,0.860,0.881]
    mag_A = [1,0.998,0.906,0.830,0.874,0.878,0.867,0.869,0.865,0.857,0.879]
    mag_A = [1,0.998,0.908,0.831,0.875,0.879,0.869,0.870,0.867,0.859,0.880]
    mag_A = [1,0.999,0.908,0.831,0.876,0.879,0.869,0.871,0.869,0.859,0.881]
    mag_A = [1,0.999,0.907,0.830,0.875,0.878,0.868,0.870,0.868,0.858,0.880]
    #final
    mag_A = [1,0.999,0.907,0.830,0.875,0.878,0.868,0.870,0.868,0.858,0.880]
    #temp
    # mag_A = [1,0.999,0.907,0.830,0.875,0.878,0.868,0.870,0.868,0.9,0.95]

    #ac stark shift calibration
    mag_A = [0.999,1,0.911,0.835,0.880,0.885,0.876,0.877,0.876,0.870,0.894]
    mag_A = [0.997,1,0.917,0.842,0.886,0.900,0.881,0.881,0.886,0.884,0.914]
    mag_A = [0.998,1,0.928,0.851,0.896,0.912,0.900,0.904,0.915,0.916,0.947]
    mag_A = [1,0.995,0.926,0.852,0.896,0.931,0.911,0.934,0.947,0.933,0.955]
    mag_A = [1,0.983,0.911,0.839,0.890,0.918,0.918,0.961,0.967,0.940,1]
    mag_A = [0.968,0.960,0.893,0.822,0.871,0.906,0.907,0.937,0.942,0.928,1]
    mag_A = [0.946,0.952,0.884,0.831,0.880,0.911,0.906,0.923,0.923,0.936,1]
    mag_A = [0.930,0.937,0.889,0.824,0.873,0.900,0.904,0.908,0.901,0.939,1]
    mag_A = [0.932,0.937,0.902,0.832,0.888,0.917,0.914,0.914,0.912,0.958,1]
    mag_A = [0.927,0.922,0.889,0.822,0.875,0.911,0.914,0.913,0.903,0.962,1]
    mag_A = [0.934,0.933,0.893,0.826,0.877,0.910,0.912,0.917,0.908,0.955,1]
    mag_A = [0.923,0.925,0.889,0.821,0.876,0.909,0.912,0.913,0.905,0.958,1]
    mag_A = [0.921,0.931,0.889,0.823,0.876,0.909,0.912,0.915,0.901,0.955,1]

    mag_A = [0.923,0.925,0.889,0.821,0.876,0.909,0.912,0.913,0.905,0.958,1]


    # freq_A = [111e6, 112e6, 113e6, 114e6]
    #freq_A = [int(110e6)]
    A = wavgen.waveform.Superposition(freq_A, mags = mag_A)  # One via the default constructor...
    A.set_phases(r[:len(freq_A)])
    # filename = 'card_single'  # Location for our HDF5 file
    # A.compute_waveform(filename, 'A')

    print(freq_A)
    dwCard = wavgen.Card()
    dwCard.setup_channels(amplitude = 350, use_filter=False)

    dwCard.load_waveforms(A)
    dwCard.wiggle_output()